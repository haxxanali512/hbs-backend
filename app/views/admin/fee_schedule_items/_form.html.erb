<%# Admin Fee Schedule Item form %>
<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
  <% if @fee_schedule_item.errors.any? %>
    <div class="mb-6 bg-red-50 border border-red-200 text-red-800 rounded-md p-4">
      <div class="font-semibold mb-2"><%= pluralize(@fee_schedule_item.errors.count, "error") %> prohibited this fee schedule item from being saved:</div>
      <ul class="list-disc ml-6 text-sm">
        <% @fee_schedule_item.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with(model: [@fee_schedule, @fee_schedule_item], 
      url: (@fee_schedule_item.persisted? ? 
        admin_fee_schedule_fee_schedule_item_path(@fee_schedule, @fee_schedule_item) : 
        admin_fee_schedule_fee_schedule_items_path(@fee_schedule)), 
      method: (@fee_schedule_item.persisted? ? :patch : :post),
      local: true, class: "space-y-6") do |f| %>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <%= f.label :procedure_code_id, "Procedure Code", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :procedure_code_id, 
            options_from_collection_for_select(@procedure_codes, :id, :code_with_description, @fee_schedule_item.procedure_code_id),
            { prompt: "Select Procedure Code" },
            { class: "w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" } %>
      </div>
      <div>
        <%= f.label :unit_price, "Unit Price", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <span class="text-gray-500 sm:text-sm">$</span>
          </div>
          <%= f.number_field :unit_price, 
              step: 0.01, 
              min: 0,
              class: "w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <%= f.label :pricing_rule, "Pricing Rule", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :pricing_rule, 
            options_for_select([
              ["Per Unit", "per_unit"],
              ["Per Hour", "per_hour"],
              ["Per Session", "per_session"],
              ["Per Visit", "per_visit"],
              ["Fixed", "fixed"]
            ], @fee_schedule_item.pricing_rule),
            { prompt: "Select Pricing Rule" },
            { class: "w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" } %>
      </div>
      <div class="flex items-center space-x-6">
        <div class="flex items-center">
          <%= f.check_box :active, class: "h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" %>
          <%= f.label :active, "Active", class: "ml-2 block text-sm text-gray-900" %>
        </div>
        <div class="flex items-center">
          <%= f.check_box :locked, class: "h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" %>
          <%= f.label :locked, "Locked", class: "ml-2 block text-sm text-gray-900" %>
        </div>
      </div>
    </div>

    <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200">
      <%= link_to "Cancel", admin_fee_schedule_fee_schedule_items_path(@fee_schedule), 
          class: "bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors" %>
      <%= f.submit (@fee_schedule_item.persisted? ? "Update Item" : "Create Item"), 
          class: "bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors" %>
    </div>
  <% end %>
</div>
